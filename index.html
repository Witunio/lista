<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Dołącz do społeczności graczy</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f2f2f2; text-align: center; }
    #form { margin: 20px auto; padding: 20px; background: white; width: 300px; border-radius: 10px; }
    input { width: 90%; margin: 5px 0; padding: 8px; }
    button { padding: 8px 16px; border: none; border-radius: 5px; background: #4CAF50; color: white; cursor: pointer; }
    #lista { margin-top: 20px; background: white; width: 300px; margin-left:auto; margin-right:auto; padding: 10px; border-radius: 10px; text-align: left; }
    #regulamin-box { font-size: 10px; margin-top: 50px; color: #999; cursor: pointer; }
    #regulamin { display: none; font-size: 12px; margin-top: 10px; color: #333; }
  </style>
</head>
<body>
  <h2>Dołącz do społeczności graczy</h2>

  <div id="form">
    <input id="nick" type="text" placeholder="Twój nick (wymagany)" required>
    <input id="discord" type="text" placeholder="Twój Discord (opcjonalnie)">
    <button onclick="wyslij()">Dodaj</button>
  </div>

  <div id="lista">
    <h3>Lista graczy:</h3>
    <ul id="gracze"></ul>
  </div>

  <div id="regulamin-box" onclick="toggleRegulamin()">Regulamin</div>
  <div id="regulamin">Dodając nick wyrażasz zgodę na przetwarzanie danych w celu wyświetlenia na liście i wysłania na Discord.</div>

<script>
const API_URL = "https://workers-playground-super-mouse-fc07.witunuipl.workers.dev"; // Twój Worker

async function wyslij() {
  const nick = document.getElementById("nick").value.trim();
  const discord = document.getElementById("discord").value.trim();

  if (!nick) {
    alert("Podaj nick!");
    return;
  }

  // Wyślij dane do Workera
  await fetch(API_URL + "/add", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ nick, discord })
  });

  document.getElementById("nick").value = "";
  document.getElementById("discord").value = "";

  pobierzListe();
}

// Pobierz listę z Workera
async function pobierzListe() {
  const res = await fetch(API_URL + "/list");
  const data = await res.json();

  const ul = document.getElementById("gracze");
  ul.innerHTML = "";
  data.forEach(u => {
    const li = document.createElement("li");
    li.textContent = u.nick + (u.discord ? " ("+u.discord+")" : "");
    ul.appendChild(li);
  });
}

function toggleRegulamin() {
  const reg = document.getElementById("regulamin");
  reg.style.display = reg.style.display === "none" ? "block" : "none";
}

pobierzListe();
</script>
</body>
</html>

